this.CABLES=this.CABLES||{},this.CABLES.COREMODULES=this.CABLES.COREMODULES||{},this.CABLES.COREMODULES.Vargetset=function(t){var e={};function i(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){CABLES.VarSetOpWrapper=class{constructor(t,e,i,a){this._valuePort=i,this._varNamePort=a,this._op=t,this._type=e,this._btnCreate=t.inTriggerButton("Create new variable"),this._btnCreate.setUiAttribs({hidePort:!0}),this._btnCreate.onTriggered=this._createVar.bind(this),this._helper=t.inUiTriggerButtons("",["Rename"]),this._helper.setUiAttribs({hidePort:!0}),this._helper.onTriggered=e=>{"Rename"==e&&CABLES.CMD.PATCH.renameVariable(t.varName.get())},this._op.setPortGroup("Variable",[this._helper,this._varNamePort,this._btnCreate]),this._op.on("uiParamPanel",this._updateVarNamesDropdown.bind(this)),this._op.patch.addEventListener("variablesChanged",this._updateName.bind(this)),this._op.patch.addEventListener("variableRename",this._renameVar.bind(this)),this._varNamePort.onChange=this._updateName.bind(this),this._valuePort.onChange=this._setVarValue.bind(this),this._valuePort.changeAlways=!0,this._op.init=()=>{this._updateName(),this._setVarValue(),this._updateErrorUi()}}_updateErrorUi(){CABLES.UI&&(this._varNamePort.get()?this._op.setUiError("novarname",null):this._op.setUiError("novarname","no variable selected"))}_updateName(){const t=this._varNamePort.get();CABLES.UI&&this._op.setTitle("set #"+t),this._updateErrorUi();const e=this._op.patch.getVar(t);e&&!e.type&&(e.type=this._type),this._op.patch.hasVar(t)||this._setVarValue(),this._updateVarNamesDropdown(),this._op.isCurrentUiOp()&&this._op.refreshParams()}_createVar(){CABLES.CMD.PATCH.createVariable(this._op,this._type,()=>{this._updateName()})}_updateVarNamesDropdown(){if(CABLES.UI){const t=[],e=this._op.patch.getVars();for(const i in e)e[i].type==this._type&&"0"!=i&&t.push(i);this._varNamePort.uiAttribs.values=t}}_renameVar(t,e){t==this._varNamePort.get()&&(this._varNamePort.set(e),this._updateName())}_setVarValue(){this._op.patch.setVarValue(this._varNamePort.get(),this._valuePort.get())}},CABLES.VarGetOpWrapper=class{constructor(t,e,i,a){this._op=t,this._type=e,this._varnamePort=i,this._variable=null,this._valueOutPort=a,this._op.on("uiParamPanel",this._updateVarNamesDropdown.bind(this)),this._op.patch.on("variableRename",this._renameVar.bind(this)),this._op.patch.on("variableDeleted",t=>{this._op.isCurrentUiOp()&&this._op.refreshParams()}),this._varnamePort.onChange=this._init.bind(this),this._op.patch.addEventListener("variablesChanged",this._init.bind(this)),this._op.onDelete=function(){this._variable&&this._variable.removeListener(this._setValueOut.bind(this))},this._op.init=()=>{this._init()}}_renameVar(t,e){t==this._varnamePort.get()&&(this._varnamePort.set(e),this._updateVarNamesDropdown())}_updateVarNamesDropdown(){if(CABLES.UI){const t=[],e=this._op.patch.getVars();for(const i in e)e[i].type==this._type&&"0"!=i&&t.push(i);this._op.varName.uiAttribs.values=t}}_setValueOut(t){this._updateVarNamesDropdown(),this._valueOutPort.set(t)}_init(){this._updateVarNamesDropdown(),this._variable&&this._variable.removeListener(this._setValueOut.bind(this)),this._variable=this._op.patch.getVar(this._op.varName.get()),this._variable?(this._variable.addListener(this._setValueOut.bind(this)),this._op.setUiError("unknownvar",null),this._op.setTitle("#"+this._varnamePort.get()),this._valueOutPort.set(this._variable.getValue())):(this._op.setUiError("unknownvar","unknown variable! - there is no setVariable with this name ("+this._varnamePort.get()+")"),this._op.setTitle("#invalid"),this._valueOutPort.set(0))}}}]).Cables;